<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thumbnail Builder - Create</title>
    <link rel="stylesheet" href="styles.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Inter:wght@300;400;500;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>

<body class="create-mode">

    <!-- Left Stepper - v2.0 (Video step removed) -->
    <aside class="stepper-sidebar">
        <a href="index.html" class="logo-small">
            <div class="logo-icon-sm"></div>
        </a>
        <ul class="steps-list">
            <li class="step-item active" data-step="1">
                <div class="step-num">1</div>
                <span class="step-label">Face</span>
            </li>
            <li class="step-item" data-step="2">
                <div class="step-num">2</div>
                <span class="step-label">Style</span>
            </li>
            <li class="step-item" data-step="3">
                <div class="step-num">3</div>
                <span class="step-label">Brief</span>
            </li>
            <li class="step-item" data-step="4">
                <div class="step-num">4</div>
                <span class="step-label">Thumbnails</span>
            </li>
            <li class="step-item" data-step="5">
                <div class="step-num">5</div>
                <span class="step-label">Export</span>
            </li>
        </ul>
        <div class="stepper-footer">
            <div class="user-avatar-sm"></div>
        </div>
    </aside>

    <!-- Main Workspace -->
    <div class="workspace">

        <!-- Top Bar -->
        <header class="top-bar">
            <div class="video-context">
                <div class="video-icon-placeholder"><i class="fas fa-image"></i></div>
                <span class="video-title-display">New Thumbnail Session</span>
            </div>
            <div class="top-actions">
                <button class="btn-ghost">Save Draft</button>
            </div>
        </header>

        <!-- Main Canvas -->
        <main class="canvas">

            <!-- Step 1: Face -->
            <div class="step-content active" id="step-1">
                <div class="step-header">
                    <h2>Upload Your Face</h2>
                    <p>Weâ€™ll imprint your face into the thumbnails so your channel feels consistent and recognizable.
                    </p>
                </div>
                <div class="upload-area">
                    <div class="upload-box" id="upload-box">
                        <i class="fas fa-cloud-upload-alt upload-icon"></i>
                        <h3>Upload 3â€“10 photos of your face</h3>
                        <ul>
                            <li>Front-facing & side profiles</li>
                            <li>Different expressions (shocked, happy, angry)</li>
                            <li>Bright, clear lighting</li>
                        </ul>
                        <input type="file" id="face-input" multiple accept="image/*" style="display:none">
                        <button class="btn btn-secondary" id="browse-btn">Browse Files</button>
                    </div>
                    <div class="face-gallery" id="face-gallery">
                        <!-- Uploaded faces will appear here -->
                    </div>
                </div>
            </div>

            <!-- Step 2: Style & Expression (v2.0) -->
            <div class="step-content" id="step-2">
                <div class="step-header">
                    <h2>Choose Your Style</h2>
                    <p>Select a niche to match your content and an expression for your thumbnail.</p>
                </div>
                <div class="style-grid-layout">
                    <!-- Niche Selector -->
                    <div class="niche-selector">
                        <h3>Content Niche</h3>
                        <div class="niche-grid" id="niche-grid">
                            <div class="niche-card active" data-niche="reaction">
                                <i class="fas fa-fire"></i>
                                <span>Reaction</span>
                            </div>
                            <div class="niche-card" data-niche="gaming">
                                <i class="fas fa-gamepad"></i>
                                <span>Gaming</span>
                            </div>
                            <div class="niche-card" data-niche="tech">
                                <i class="fas fa-laptop-code"></i>
                                <span>Tech</span>
                            </div>
                            <div class="niche-card" data-niche="finance">
                                <i class="fas fa-chart-line"></i>
                                <span>Finance</span>
                            </div>
                            <div class="niche-card" data-niche="fitness">
                                <i class="fas fa-dumbbell"></i>
                                <span>Fitness</span>
                            </div>
                            <div class="niche-card" data-niche="beauty">
                                <i class="fas fa-spa"></i>
                                <span>Beauty</span>
                            </div>
                            <div class="niche-card" data-niche="cooking">
                                <i class="fas fa-utensils"></i>
                                <span>Cooking</span>
                            </div>
                            <div class="niche-card" data-niche="travel">
                                <i class="fas fa-plane"></i>
                                <span>Travel</span>
                            </div>
                            <div class="niche-card" data-niche="tutorial">
                                <i class="fas fa-chalkboard-teacher"></i>
                                <span>Tutorial</span>
                            </div>
                            <div class="niche-card" data-niche="podcast">
                                <i class="fas fa-microphone"></i>
                                <span>Podcast</span>
                            </div>
                        </div>
                    </div>

                    <!-- Expression Selector -->
                    <div class="expression-selector">
                        <h3>Your Expression</h3>
                        <div class="expression-grid" id="expression-grid">
                            <div class="expression-card active" data-expression="excited">
                                <div class="expression-emoji">ðŸ˜„</div>
                                <span>Excited</span>
                            </div>
                            <div class="expression-card" data-expression="shocked">
                                <div class="expression-emoji">ðŸ˜±</div>
                                <span>Shocked</span>
                            </div>
                            <div class="expression-card" data-expression="curious">
                                <div class="expression-emoji">ðŸ¤”</div>
                                <span>Curious</span>
                            </div>
                            <div class="expression-card" data-expression="angry">
                                <div class="expression-emoji">ðŸ˜ </div>
                                <span>Angry</span>
                            </div>
                            <div class="expression-card" data-expression="confident">
                                <div class="expression-emoji">ðŸ˜Ž</div>
                                <span>Confident</span>
                            </div>
                            <div class="expression-card" data-expression="determined">
                                <div class="expression-emoji">ðŸ’ª</div>
                                <span>Determined</span>
                            </div>
                        </div>
                    </div>

                    <!-- V2: Advanced Customization (Collapsed by default) -->
                    <div class="advanced-options">
                        <button class="advanced-toggle" id="toggle-advanced">
                            <i class="fas fa-sliders-h"></i>
                            Advanced Options
                            <i class="fas fa-chevron-down toggle-arrow"></i>
                        </button>
                        <div class="advanced-panel" id="advanced-panel">
                            <!-- Compositing Mode -->
                            <div class="option-group">
                                <label>Subject Blending</label>
                                <div class="option-buttons" id="compositing-options">
                                    <button class="option-btn active" data-compositing="auto" title="Smart auto-select based on niche">
                                        <i class="fas fa-magic"></i> Auto
                                    </button>
                                    <button class="option-btn" data-compositing="natural" title="Seamless blend with background">
                                        <i class="fas fa-leaf"></i> Natural
                                    </button>
                                    <button class="option-btn" data-compositing="subtleRim" title="Soft rim lighting">
                                        <i class="fas fa-sun"></i> Rim Light
                                    </button>
                                    <button class="option-btn" data-compositing="sticker" title="Bold cutout effect">
                                        <i class="fas fa-cut"></i> Cutout
                                    </button>
                                </div>
                            </div>

                            <!-- Background Quality -->
                            <div class="option-group">
                                <label>Background Quality</label>
                                <div class="option-buttons" id="background-options">
                                    <button class="option-btn" data-background="basic" title="Clean minimal">
                                        <i class="fas fa-minus"></i> Basic
                                    </button>
                                    <button class="option-btn active" data-background="pro" title="Layered with depth">
                                        <i class="fas fa-star"></i> Pro
                                    </button>
                                    <button class="option-btn" data-background="cinematic" title="Film-quality dramatic">
                                        <i class="fas fa-film"></i> Cinematic
                                    </button>
                                </div>
                            </div>

                            <!-- Text Style -->
                            <div class="option-group">
                                <label>Text Style</label>
                                <div class="option-buttons" id="text-style-options">
                                    <button class="option-btn active" data-textstyle="auto" title="Match niche style">
                                        <i class="fas fa-magic"></i> Auto
                                    </button>
                                    <button class="option-btn" data-textstyle="viral" title="Maximum impact yellow">
                                        <i class="fas fa-bolt"></i> Viral
                                    </button>
                                    <button class="option-btn" data-textstyle="money" title="Gold wealth style">
                                        <i class="fas fa-dollar-sign"></i> Money
                                    </button>
                                    <button class="option-btn" data-textstyle="minimal" title="Clean elegant">
                                        <i class="fas fa-feather"></i> Minimal
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 3: Brief & Text (v2.0) -->
            <div class="step-content" id="step-3">
                <div class="step-header">
                    <h2>Describe Your Thumbnail</h2>
                    <p>Tell us what you want and add bold text for your thumbnail.</p>
                </div>
                <div class="brief-container">
                    <div class="brief-form">
                        <!-- Thumbnail Text Input -->
                        <div class="input-card thumbnail-text-card">
                            <label for="thumbnail-text">
                                <i class="fas fa-font"></i>
                                Thumbnail Text (1-4 words)
                            </label>
                            <input type="text" id="thumbnail-text" class="thumbnail-text-input"
                                   placeholder="e.g., HOLY DROP, $50K, WHY??" maxlength="30">
                            <p class="input-hint">This bold text will be overlaid on your thumbnail</p>
                        </div>

                        <!-- Brief Textarea -->
                        <div class="input-card">
                            <label for="brief-input">
                                <i class="fas fa-pen"></i>
                                Describe Your Scene
                            </label>
                            <textarea id="brief-input" class="brief-input"
                                      placeholder="Describe your thumbnail idea... e.g., 'Me looking shocked at a huge stack of money, dark dramatic background'"></textarea>
                        </div>

                        <!-- Quick Suggestions -->
                        <div class="quick-chips">
                            <span class="chip-label">Scene Ideas:</span>
                            <button class="chip" data-append="luxury penthouse background">Luxury</button>
                            <button class="chip" data-append="jungle adventure setting">Jungle</button>
                            <button class="chip" data-append="neon city skyline">City</button>
                            <button class="chip" data-append="clean studio setup">Studio</button>
                            <button class="chip" data-append="dramatic spotlight">Spotlight</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 4: Thumbnails (v2.0) -->
            <div class="step-content" id="step-4">
                <div class="step-header">
                    <h2>Review Your Thumbnails</h2>
                    <p>Select your favorite variant to export.</p>
                </div>
                <div class="thumbnails-layout">
                    <div class="thumbnails-grid">
                        <!-- Generated Thumbnails -->
                        <div class="thumb-card">
                            <div class="thumb-img-placeholder" style="background: #222;">V1</div>
                            <div class="thumb-actions">
                                <span>Variant 1</span>
                                <i class="far fa-star"></i>
                            </div>
                        </div>
                        <div class="thumb-card active">
                            <div class="thumb-img-placeholder" style="background: #333;">V2</div>
                            <div class="thumb-actions">
                                <span>Variant 2</span>
                                <i class="fas fa-star" style="color: var(--primary-orange)"></i>
                            </div>
                        </div>
                        <div class="thumb-card">
                            <div class="thumb-img-placeholder" style="background: #222;">V3</div>
                            <div class="thumb-actions">
                                <span>Variant 3</span>
                                <i class="far fa-star"></i>
                            </div>
                        </div>
                        <div class="thumb-card">
                            <div class="thumb-img-placeholder" style="background: #222;">V4</div>
                            <div class="thumb-actions">
                                <span>Variant 4</span>
                                <i class="far fa-star"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 5: Export (v2.0) -->
            <div class="step-content" id="step-5">
                <div class="step-header">
                    <h2>Export & Test</h2>
                    <p>Select a variant and download or send to Title Tester Pro.</p>
                </div>

                <!-- Variant Selection -->
                <div class="export-variant-selector">
                    <h3>Select Variant to Export</h3>
                    <div class="export-thumbnails-grid" id="export-thumbnails-grid">
                        <!-- Will be populated with generated variants -->
                    </div>
                </div>

                <div class="export-options">
                    <div class="export-card">
                        <i class="fab fa-youtube export-icon"></i>
                        <h3>Download for YouTube</h3>
                        <p>Get the high-res PNG ready for upload.</p>
                        <button class="btn btn-secondary" id="btn-download-png">Download PNG</button>
                    </div>
                    <div class="export-card highlight">
                        <i class="fas fa-rocket export-icon"></i>
                        <h3>Send to Testing</h3>
                        <p>Export directly to Title Tester Pro v8 for A/B testing.</p>
                        <button class="btn btn-primary" id="btn-export-tester">Export to Title Tester</button>
                    </div>
                </div>
            </div>

        </main>

        <!-- Right Panel (Context) -->
        <aside class="context-panel">
            <div class="panel-content" id="panel-step-1">
                <h3>Pro Tips</h3>
                <ul class="tips-list">
                    <li>Use a plain background if possible.</li>
                    <li>Ensure your face is well-lit.</li>
                    <li>Exaggerate your expressions slightly.</li>
                </ul>
                <div class="example-faces">
                    <h4>Examples</h4>
                    <div class="example-face-grid">
                        <div class="ex-face"></div>
                        <div class="ex-face"></div>
                    </div>
                </div>
            </div>

            <div class="panel-content hidden" id="panel-step-2">
                <h3>Style Summary</h3>
                <div class="style-summary-card">
                    <div class="summary-row">
                        <span>Niche</span>
                        <strong id="selected-niche-display">Reaction</strong>
                    </div>
                    <div class="summary-row">
                        <span>Expression</span>
                        <strong id="selected-expression-display">Excited</strong>
                    </div>
                </div>
                <p class="tip-text">The AI will match colors and lighting to your selected niche.</p>
            </div>

            <div class="panel-content hidden" id="panel-step-3">
                <h3>Brief Summary</h3>
                <div class="brief-summary">
                    <div class="summary-item">
                        <label>Text Overlay</label>
                        <span id="thumbnail-text-display">Not set</span>
                    </div>
                    <div class="summary-item">
                        <label>Scene</label>
                        <span id="brief-display">Not set</span>
                    </div>
                </div>
            </div>

            <div class="panel-content hidden" id="panel-step-4">
                <h3>Selected Variant</h3>
                <div class="selected-preview">
                    <div class="preview-box" id="selected-variant-preview">--</div>
                </div>
                <div class="generation-info">
                    <p class="text-muted">Variants generated with your settings.</p>
                </div>
            </div>

            <div class="panel-content hidden" id="panel-step-5">
                <h3>Export History</h3>
                <ul class="export-list" id="export-history">
                    <li class="empty-state">No exports yet</li>
                </ul>
            </div>
        </aside>

        <!-- Bottom Sticky Bar -->
        <footer class="bottom-bar">
            <button class="btn btn-secondary" id="btn-back" disabled>Back</button>
            <button class="btn btn-primary" id="btn-next">Save Face & Continue</button>
        </footer>

    </div>

    <script src="app.js"></script>
    <script>
        // ============================================================
        // ThumbnailBuilder v2.0 - UI State Management
        // ============================================================

        const tbState = {
            niche: 'reaction',
            expression: 'excited',
            thumbnailText: '',
            brief: '',
            // V2: Advanced customization options
            compositingMode: 'auto',     // auto, natural, subtleRim, sticker
            backgroundTier: 'pro',       // basic, pro, cinematic
            textStyle: 'auto'            // auto, viral, money, minimal
        };

        // Niche card selection
        document.querySelectorAll('.niche-card').forEach(card => {
            card.addEventListener('click', () => {
                document.querySelectorAll('.niche-card').forEach(c => c.classList.remove('active'));
                card.classList.add('active');
                tbState.niche = card.dataset.niche;
                // Update display
                const nicheDisplay = document.getElementById('selected-niche-display');
                if (nicheDisplay) {
                    nicheDisplay.textContent = card.querySelector('span').textContent;
                }
            });
        });

        // Expression card selection
        document.querySelectorAll('.expression-card').forEach(card => {
            card.addEventListener('click', () => {
                document.querySelectorAll('.expression-card').forEach(c => c.classList.remove('active'));
                card.classList.add('active');
                tbState.expression = card.dataset.expression;
                // Update display
                const expressionDisplay = document.getElementById('selected-expression-display');
                if (expressionDisplay) {
                    expressionDisplay.textContent = card.querySelector('span').textContent;
                }
            });
        });

        // Thumbnail text input
        const thumbnailTextInput = document.getElementById('thumbnail-text');
        if (thumbnailTextInput) {
            thumbnailTextInput.addEventListener('input', (e) => {
                tbState.thumbnailText = e.target.value;
                const display = document.getElementById('thumbnail-text-display');
                if (display) {
                    display.textContent = e.target.value || 'Not set';
                }
            });
        }

        // Brief textarea
        const briefInput = document.getElementById('brief-input');
        if (briefInput) {
            briefInput.addEventListener('input', (e) => {
                tbState.brief = e.target.value;
                const display = document.getElementById('brief-display');
                if (display) {
                    const shortened = e.target.value.length > 40
                        ? e.target.value.substring(0, 40) + '...'
                        : e.target.value || 'Not set';
                    display.textContent = shortened;
                }
            });
        }

        // Chip buttons for brief (with data-append attribute)
        document.querySelectorAll('.chip[data-append]').forEach(chip => {
            chip.addEventListener('click', () => {
                const textarea = document.getElementById('brief-input');
                if (textarea) {
                    const appendText = chip.dataset.append;
                    textarea.value += (textarea.value ? ', ' : '') + appendText;
                    textarea.dispatchEvent(new Event('input'));
                }
            });
        });

        // ============================================================
        // V2: Advanced Options Panel
        // ============================================================

        // Toggle advanced options panel
        const toggleAdvanced = document.getElementById('toggle-advanced');
        const advancedPanel = document.getElementById('advanced-panel');
        if (toggleAdvanced && advancedPanel) {
            toggleAdvanced.addEventListener('click', () => {
                advancedPanel.classList.toggle('open');
                toggleAdvanced.classList.toggle('active');
            });
        }

        // Compositing mode selection
        document.querySelectorAll('#compositing-options .option-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('#compositing-options .option-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                tbState.compositingMode = btn.dataset.compositing;
            });
        });

        // Background tier selection
        document.querySelectorAll('#background-options .option-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('#background-options .option-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                tbState.backgroundTier = btn.dataset.background;
            });
        });

        // Text style selection
        document.querySelectorAll('#text-style-options .option-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('#text-style-options .option-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                tbState.textStyle = btn.dataset.textstyle;
            });
        });

        // Logout function
        function logout() {
            localStorage.removeItem('tb_token');
            localStorage.removeItem('tb_user');
            window.location.href = '/login.html';
        }

        // --- FILE UPLOAD FUNCTIONALITY ---
        const faceInput = document.getElementById('face-input');
        const browseBtn = document.getElementById('browse-btn');
        const uploadBox = document.getElementById('upload-box');
        const faceGallery = document.getElementById('face-gallery');
        // v2.0: Expose to window for app.js access
        window.uploadedFaces = [];

        // Click to browse
        browseBtn.addEventListener('click', (e) => {
            e.preventDefault();
            faceInput.click();
        });

        // Drag and drop
        uploadBox.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadBox.style.borderColor = '#ff6b35';
            uploadBox.style.background = 'rgba(255,107,53,0.1)';
        });

        uploadBox.addEventListener('dragleave', (e) => {
            e.preventDefault();
            uploadBox.style.borderColor = '';
            uploadBox.style.background = '';
        });

        uploadBox.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadBox.style.borderColor = '';
            uploadBox.style.background = '';
            const files = e.dataTransfer.files;
            handleFiles(files);
        });

        // File input change
        faceInput.addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });

        function handleFiles(files) {
            const token = localStorage.getItem('tb_token');

            Array.from(files).forEach(file => {
                if (!file.type.startsWith('image/')) {
                    alert('Please upload only image files');
                    return;
                }

                // Show preview immediately
                const reader = new FileReader();
                reader.onload = (e) => {
                    const previewId = 'preview-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
                    addFaceCard(e.target.result, 'Uploading...', previewId);

                    // Upload to server
                    uploadFace(file, previewId, token);
                };
                reader.readAsDataURL(file);
            });
        }

        function addFaceCard(src, status, id) {
            const card = document.createElement('div');
            card.className = 'face-card';
            card.id = id;

            const img = document.createElement('img');
            img.src = src;
            img.alt = 'Face';

            const badge = document.createElement('span');
            badge.className = 'status-badge ' + (status === 'Good' ? 'good' : status === 'Uploading...' ? 'warning' : 'error');
            badge.textContent = status;

            const btn = document.createElement('button');
            btn.className = 'remove-face';
            btn.textContent = 'Ã—';
            btn.addEventListener('click', () => removeFace(id));

            card.appendChild(img);
            card.appendChild(badge);
            card.appendChild(btn);
            faceGallery.appendChild(card);
        }

        function updateFaceCard(id, status) {
            const card = document.getElementById(id);
            if (card) {
                const badge = card.querySelector('.status-badge');
                badge.textContent = status;
                badge.className = 'status-badge ' + (status === 'Good' ? 'good' : 'error');
            }
        }

        async function uploadFace(file, previewId, token) {
            const formData = new FormData();
            formData.append('face', file);

            try {
                const res = await fetch('/api/faces/upload', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + token
                    },
                    body: formData
                });

                if (res.status === 401) {
                    localStorage.removeItem('tb_token');
                    window.location.href = '/login.html';
                    return;
                }

                const data = await res.json();

                if (res.ok) {
                    updateFaceCard(previewId, 'Good');
                    window.uploadedFaces.push(data.face);
                } else {
                    updateFaceCard(previewId, 'Failed');
                    console.error('Upload failed:', data.error);
                }
            } catch (err) {
                updateFaceCard(previewId, 'Failed');
                console.error('Upload error:', err);
            }
        }

        function removeFace(id) {
            const card = document.getElementById(id);
            if (card) {
                card.remove();
            }
        }

        // Load existing faces on page load
        async function loadExistingFaces() {
            const token = localStorage.getItem('tb_token');
            if (!token) return;

            try {
                const res = await fetch('/api/faces', {
                    headers: { 'Authorization': 'Bearer ' + token }
                });

                if (res.ok) {
                    const data = await res.json();
                    if (data.profile && data.profile.images) {
                        data.profile.images.forEach(img => {
                            const id = 'existing-' + img.id;
                            addFaceCard(img.url, 'Good', id);
                            window.uploadedFaces.push(img);
                        });
                    }
                }
            } catch (err) {
                console.error('Error loading faces:', err);
            }
        }

        // Load faces when page loads
        loadExistingFaces();
    </script>
    <style>
        .face-card {
            position: relative;
        }
        .face-card .remove-face {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: rgba(255,0,0,0.8);
            color: white;
            border: none;
            cursor: pointer;
            font-size: 14px;
            line-height: 1;
            display: none;
        }
        .face-card:hover .remove-face {
            display: block;
        }
        .status-badge.error {
            background: rgba(255,100,100,0.3);
            color: #ff6b6b;
        }
        .status-badge.warning {
            background: rgba(255,200,100,0.3);
            color: #ffc864;
        }

        /* V2: Advanced Options Panel Styles */
        .advanced-options {
            margin-top: 24px;
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 16px;
        }

        .advanced-toggle {
            width: 100%;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            color: rgba(255,255,255,0.7);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .advanced-toggle:hover {
            background: rgba(255,255,255,0.08);
            color: #fff;
        }

        .advanced-toggle.active {
            background: rgba(255,107,53,0.1);
            border-color: var(--primary-orange);
            color: var(--primary-orange);
        }

        .advanced-toggle .toggle-arrow {
            margin-left: auto;
            transition: transform 0.3s ease;
        }

        .advanced-toggle.active .toggle-arrow {
            transform: rotate(180deg);
        }

        .advanced-panel {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }

        .advanced-panel.open {
            max-height: 400px;
            padding-top: 16px;
        }

        .option-group {
            margin-bottom: 16px;
        }

        .option-group label {
            display: block;
            font-size: 12px;
            color: rgba(255,255,255,0.6);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .option-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .option-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 12px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 6px;
            color: rgba(255,255,255,0.7);
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .option-btn:hover {
            background: rgba(255,255,255,0.1);
            color: #fff;
        }

        .option-btn.active {
            background: var(--primary-orange);
            border-color: var(--primary-orange);
            color: #fff;
        }

        .option-btn i {
            font-size: 12px;
        }
    </style>
</body>

</html>